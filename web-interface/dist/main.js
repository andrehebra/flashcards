/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t,e,n,i,s={444:(t,e,n)=>{n.d(e,{$s:()=>S,BH:()=>l,L:()=>r,LL:()=>m,P0:()=>a,Sg:()=>h,ZR:()=>g,aH:()=>c,eu:()=>d,hl:()=>f,m9:()=>C,ru:()=>u,vZ:()=>v,zI:()=>p});const i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=s>>2,h=(3&s)<<4|o>>4;let u=(15&o)<<2|c>>6,f=63&c;a||(f=64,r||(u=64)),i.push(n[l],n[h],n[u],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==r||null==o||null==a)throw Error();const c=s<<2|r>>4;if(i.push(c),64!==o){const t=r<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},r=function(t){return function(t){const e=i(t);return s.encodeByteArray(e,!0)}(t).replace(/\./g,"")},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return s.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},a=t=>{const e=(t=>{var e,n;return null===(n=null===(e=o())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},c=()=>{var t;return null===(t=o())||void 0===t?void 0:t.config};class l{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function h(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}function u(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function f(){try{return"object"==typeof indexedDB}catch(t){return!1}}function d(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function p(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class g extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m.prototype.create)}}class m{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(y,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new g(i,o,n)}}const y=/\{\$([^}]+)}/g;function v(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(w(n)&&w(r)){if(!v(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function w(t){return null!==t&&"object"==typeof t}const b=1e3,E=2,I=144e5,T=.5;function S(t,e=b,n=E){const i=e*Math.pow(n,t),s=Math.round(T*i*(Math.random()-.5)*2);return Math.min(I,i+s)}function C(t){return t&&t._delegate?t._delegate:t}},495:(t,e,n)=>{n.a(t,(async(t,e)=>{try{var i=n(977),s=n(845),r=n(51);const t={apiKey:"AIzaSyAyL4-gcE80oAhd3XHMugIScXnms1pDPuQ",authDomain:"flash-17cb5.firebaseapp.com",databaseURL:"https://flash-17cb5-default-rtdb.firebaseio.com",projectId:"flash-17cb5",storageBucket:"flash-17cb5.appspot.com",messagingSenderId:"92154809297",appId:"1:92154809297:web:b63c4be349d364b2482ef0",measurementId:"G-M61CNDQWVV"},o=(0,i.ZF)(t),a=((0,s.IH)(o),(0,r.ad)(o));try{const t=await(0,r.ET)((0,r.hJ)(a,"users"),{first:"Andre",last:"Lovelace",born:1815});console.log("Document written with ID: ",t.id)}catch(t){console.error("Error adding document: ",t)}console.log(a),e()}catch(t){e(t)}}),1)},238:(t,e,n)=>{n.d(e,{Jn:()=>b,KN:()=>T,Mq:()=>I,Xd:()=>m,ZF:()=>E,qX:()=>y});var i=n(463),s=n(333),r=n(444),o=n(424);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const c="@firebase/app",l="0.9.3",h=new s.Yd("@firebase/app"),u="[DEFAULT]",f={[c]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},d=new Map,p=new Map;function g(t,e){try{t.container.addComponent(e)}catch(n){h.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function m(t){const e=t.name;if(p.has(e))return h.debug(`There were multiple attempts to register component ${e}.`),!1;p.set(e,t);for(const e of d.values())g(e,t);return!0}function y(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const v=new r.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class w{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw v.create("app-deleted",{appName:this._name})}}const b="9.17.1";function E(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const s=Object.assign({name:u,automaticDataCollectionEnabled:!1},e),o=s.name;if("string"!=typeof o||!o)throw v.create("bad-app-name",{appName:String(o)});if(n||(n=(0,r.aH)()),!n)throw v.create("no-options");const a=d.get(o);if(a){if((0,r.vZ)(n,a.options)&&(0,r.vZ)(s,a.config))return a;throw v.create("duplicate-app",{appName:o})}const c=new i.H0(o);for(const t of p.values())c.addComponent(t);const l=new w(n,s,c);return d.set(o,l),l}function I(t=u){const e=d.get(t);if(!e&&t===u)return E();if(!e)throw v.create("no-app",{appName:t});return e}function T(t,e,n){var s;let r=null!==(s=f[t])&&void 0!==s?s:t;n&&(r+=`-${n}`);const o=r.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${r}" with version "${e}":`];return o&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void h.warn(t.join(" "))}m(new i.wA(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const S="firebase-heartbeat-database",C=1,A="firebase-heartbeat-store";let D=null;function _(){return D||(D=(0,o.X3)(S,C,{upgrade:(t,e)=>{0===e&&t.createObjectStore(A)}}).catch((t=>{throw v.create("idb-open",{originalErrorMessage:t.message})}))),D}async function N(t,e){try{const n=(await _()).transaction(A,"readwrite"),i=n.objectStore(A);return await i.put(e,k(t)),n.done}catch(t){if(t instanceof r.ZR)h.warn(t.message);else{const e=v.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});h.warn(e.message)}}}function k(t){return`${t.name}!${t.options.appId}`}class L{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new R(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=O();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=O(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),x(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),x(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=(0,r.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function O(){return(new Date).toISOString().substring(0,10)}class R{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,r.hl)()&&(0,r.eu)().then((()=>!0)).catch((()=>!1))}async read(){return await this._canUseIndexedDBPromise&&await async function(t){try{return(await _()).transaction(A).objectStore(A).get(k(t))}catch(t){if(t instanceof r.ZR)h.warn(t.message);else{const e=v.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});h.warn(e.message)}}}(this.app)||{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function x(t){return(0,r.L)(JSON.stringify({version:2,heartbeats:t})).length}m(new i.wA("platform-logger",(t=>new a(t)),"PRIVATE")),m(new i.wA("heartbeat",(t=>new L(t)),"PRIVATE")),T(c,l,""),T(c,l,"esm2017"),T("fire-js","")},463:(t,e,n)=>{n.d(e,{H0:()=>a,wA:()=>s});var i=n(444);class s{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const r="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:r})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=r){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=r){return this.instances.has(t)}getOptions(t=r){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===r?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=r){return this.component?this.component.multipleInstances?t:r:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},333:(t,e,n)=>{n.d(e,{Yd:()=>l,in:()=>s});const i=[];var s;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));const r={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},o=s.INFO,a={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=a[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class l{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in s))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?r[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}},845:(t,e,n)=>{n.d(e,{IH:()=>Tt});var i=n(238),s=n(333),r=n(444),o=n(463),a=n(424);const c="@firebase/installations",l="0.6.3",h=1e4,u=`w:${l}`,f="FIS_v2",d="https://firebaseinstallations.googleapis.com/v1",p=36e5,g=new r.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function m(t){return t instanceof r.ZR&&t.code.includes("request-failed")}function y({projectId:t}){return`${d}/projects/${t}/installations`}function v(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function w(t,e){const n=(await e.json()).error;return g.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function b({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function E(t){const e=await t();return e.status>=500&&e.status<600?t():e}function I(t){return new Promise((e=>{setTimeout(e,t)}))}const T=/^[cdef][\w-]{21}$/,S="";function C(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return T.test(e)?e:S}catch(t){return S}}function A(t){return`${t.appName}!${t.appId}`}const D=new Map;function _(t,e){const n=A(t);N(n,e),function(t,e){const n=(!k&&"BroadcastChannel"in self&&(k=new BroadcastChannel("[Firebase] FID Change"),k.onmessage=t=>{N(t.data.key,t.data.fid)}),k);n&&n.postMessage({key:t,fid:e}),0===D.size&&k&&(k.close(),k=null)}(n,e)}function N(t,e){const n=D.get(t);if(n)for(const t of n)t(e)}let k=null;const L="firebase-installations-database",O=1,R="firebase-installations-store";let x=null;function M(){return x||(x=(0,a.X3)(L,O,{upgrade:(t,e)=>{0===e&&t.createObjectStore(R)}})),x}async function P(t,e){const n=A(t),i=(await M()).transaction(R,"readwrite"),s=i.objectStore(R),r=await s.get(n);return await s.put(e,n),await i.done,r&&r.fid===e.fid||_(t,e.fid),e}async function F(t){const e=A(t),n=(await M()).transaction(R,"readwrite");await n.objectStore(R).delete(e),await n.done}async function V(t,e){const n=A(t),i=(await M()).transaction(R,"readwrite"),s=i.objectStore(R),r=await s.get(n),o=e(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||_(t,o.fid),o}async function U(t){let e;const n=await V(t.appConfig,(n=>{const i=function(t){return $(t||{fid:C(),registrationStatus:0})}(n),s=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(g.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=y(t),s=b(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={fid:n,authVersion:f,appId:t.appId,sdkVersion:u},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await E((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:v(t.authToken)}}throw await w("Create Installation",c)}(t,e);return P(t.appConfig,n)}catch(n){throw m(n)&&409===n.customData.serverCode?await F(t.appConfig):await P(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:B(t)}:{installationEntry:e}}(t,i);return e=s.registrationPromise,s.installationEntry}));return n.fid===S?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function B(t){let e=await j(t.appConfig);for(;1===e.registrationStatus;)await I(100),e=await j(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await U(t);return n||e}return e}function j(t){return V(t,(t=>{if(!t)throw g.create("installation-not-found");return $(t)}))}function $(t){return 1===(e=t).registrationStatus&&e.registrationTime+h<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function q({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${y(t)}/${e}/authTokens:generate`}(t,n),s=function(t,{refreshToken:e}){const n=b(t);return n.append("Authorization",function(t){return`${f} ${t}`}(e)),n}(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={installation:{sdkVersion:u,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await E((()=>fetch(i,a)));if(c.ok)return v(await c.json());throw await w("Generate Auth Token",c)}async function H(t,e=!1){let n;const i=await V(t.appConfig,(i=>{if(!G(i))throw g.create("not-registered");const s=i.authToken;if(!e&&(2===(r=s).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+p}(r)))return i;var r;if(1===s.requestStatus)return n=async function(t,e){let n=await K(t.appConfig);for(;1===n.authToken.requestStatus;)await I(100),n=await K(t.appConfig);const i=n.authToken;return 0===i.requestStatus?H(t,e):i}(t,e),i;{if(!navigator.onLine)throw g.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await q(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await P(t.appConfig,i),n}catch(n){if(!m(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await P(t.appConfig,n)}else await F(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function K(t){return V(t,(t=>{if(!G(t))throw g.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+h<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function G(t){return void 0!==t&&2===t.registrationStatus}function z(t){return g.create("missing-app-config-values",{valueName:t})}const Q="installations";(0,i.Xd)(new o.wA(Q,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw z("App Configuration");if(!t.name)throw z("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw z(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,i.qX)(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),(0,i.Xd)(new o.wA("installations-internal",(t=>{const e=t.getProvider("app").getImmediate(),n=(0,i.qX)(e,Q).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await U(e);return i?i.catch(console.error):H(e).catch(console.error),n.fid}(n),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await U(t);e&&await e}(n),(await H(n,e)).token}(n,t)}}),"PRIVATE")),(0,i.KN)(c,l),(0,i.KN)(c,l,"esm2017");const X="analytics",W="firebase_id",Y="origin",J=6e4,Z="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",tt="https://www.googletagmanager.com/gtag/js",et=new s.Yd("@firebase/analytics");function nt(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const it=new r.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),st=30,rt=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function ot(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function at(t,e=rt,n){const{appId:i,apiKey:s,measurementId:r}=t.options;if(!i)throw it.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw it.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new lt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:J),ct({appId:i,apiKey:s,measurementId:r},o,a,e)}async function ct(t,{throttleEndTimeMillis:e,backoffCount:n},i,s=rt){var o;const{appId:a,measurementId:c}=t;try{await function(t,e){return new Promise(((n,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(n,s);t.addEventListener((()=>{clearTimeout(r),i(it.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(c)return et.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:a,measurementId:c};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,s={method:"GET",headers:ot(i)},r=Z.replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw it.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return s.deleteThrottleMetadata(a),e}catch(e){const l=e;if(!function(t){if(!(t instanceof r.ZR&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(s.deleteThrottleMetadata(a),c)return et.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:a,measurementId:c};throw e}const h=503===Number(null===(o=null==l?void 0:l.customData)||void 0===o?void 0:o.httpStatus)?(0,r.$s)(n,s.intervalMillis,st):(0,r.$s)(n,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(a,u),et.debug(`Calling attemptFetch again in ${h} millis`),ct(t,u,i,s)}}class lt{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let ht,ut;async function ft(t,e,n,i,s,o,a){var c;const l=at(t);l.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&et.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>et.error(t))),e.push(l);const h=async function(){if(!(0,r.hl)())return et.warn(it.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,r.eu)()}catch(t){return et.warn(it.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[u,f]=await Promise.all([l,h]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(tt)&&n.src.includes(t))return n;return null})(o)||function(t,e){const n=document.createElement("script");n.src=`${tt}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(o,u.measurementId),ut&&(s("consent","default",ut),ut=void 0),s("js",new Date);const d=null!==(c=null==a?void 0:a.config)&&void 0!==c?c:{};return d[Y]="firebase",d.update=!0,null!=f&&(d[W]=f),s("config",u.measurementId,d),ht&&(s("set",ht),ht=void 0),u.measurementId}class dt{constructor(t){this.app=t}_delete(){return delete pt[this.app.options.appId],Promise.resolve()}}let pt={},gt=[];const mt={};let yt,vt,wt="dataLayer",bt="gtag",Et=!1;function It(t,e,n){!function(){const t=[];if((0,r.ru)()&&t.push("This is a browser extension environment."),(0,r.zI)()||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=it.create("invalid-analytics-context",{errorInfo:e});et.warn(n.message)}}();const i=t.options.appId;if(!i)throw it.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw it.create("no-api-key");et.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=pt[i])throw it.create("already-exists",{id:i});if(!Et){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(wt);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,s){let r=function(...t){window[i].push(arguments)};return window[s]&&"function"==typeof window[s]&&(r=window[s]),window[s]=function(t,e,n,i){return async function(s,r,o){try{"event"===s?await async function(t,e,n,i,s){try{let r=[];if(s&&s.send_to){let t=s.send_to;Array.isArray(t)||(t=[t]);const i=await nt(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),s=t&&e[t.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",i,s||{})}catch(t){et.error(t)}}(t,e,n,r,o):"config"===s?await async function(t,e,n,i,s,r){const o=i[s];try{if(o)await e[o];else{const t=(await nt(n)).find((t=>t.measurementId===s));t&&await e[t.appId]}}catch(t){et.error(t)}t("config",s,r)}(t,e,n,i,r,o):"consent"===s?t("consent","update",o):t("set",r)}catch(t){et.error(t)}}}(r,t,e,n),{gtagCore:r,wrappedGtag:window[s]}}(pt,gt,mt,wt,bt);vt=t,yt=e,Et=!0}return pt[i]=ft(t,gt,mt,e,yt,wt,n),new dt(t)}function Tt(t=(0,i.Mq)()){t=(0,r.m9)(t);const e=(0,i.qX)(t,X);return e.isInitialized()?e.getImmediate():function(t,e={}){const n=(0,i.qX)(t,X);if(n.isInitialized()){const t=n.getImmediate();if((0,r.vZ)(e,n.getOptions()))return t;throw it.create("already-initialized")}return n.initialize({options:e})}(t)}const St="@firebase/analytics",Ct="0.9.3";(0,i.Xd)(new o.wA(X,((t,{options:e})=>It(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),(0,i.Xd)(new o.wA("analytics-internal",(function(t){try{const e=t.getProvider(X).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=(0,r.m9)(t),async function(t,e,n,i,s){if(s&&s.global)t("event",n,i);else{const s=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(vt,pt[t.app.options.appId],e,n,i).catch((t=>et.error(t)))}(e,t,n,i)}}catch(t){throw it.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),(0,i.KN)(St,Ct),(0,i.KN)(St,Ct,"esm2017")},977:(t,e,n)=>{n.d(e,{ZF:()=>i.ZF});var i=n(238);(0,i.KN)("firebase","9.17.1","app")},51:(t,e,n)=>{n.d(e,{ET:()=>Sc,hJ:()=>Ya,ad:()=>ic});var i,s=n(238),r=n(463),o=n(333),a=n(444),c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},l={},h=h||{},u=c||self;function f(){}function d(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),m=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:v).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function I(){this.s=this.s,this.o=this.o}I.prototype.s=!1,I.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++m))},I.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const T=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function S(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function C(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(d(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let s=0;s<i;s++)t[e+s]=n[s]}else t.push(n)}}function A(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(t){}return t}();function _(t){return/^[\s\xa0]*$/.test(t)}var N=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function k(t,e){return t<e?-1:t>e?1:0}function L(){var t=u.navigator;return t&&(t=t.userAgent)?t:""}function O(t){return-1!=L().indexOf(t)}function R(t){return R[" "](t),t}R[" "]=f;var x,M,P=O("Opera"),F=O("Trident")||O("MSIE"),V=O("Edge"),U=V||F,B=O("Gecko")&&!(-1!=L().toLowerCase().indexOf("webkit")&&!O("Edge"))&&!(O("Trident")||O("MSIE"))&&!O("Edge"),j=-1!=L().toLowerCase().indexOf("webkit")&&!O("Edge");function $(){var t=u.document;return t?t.documentMode:void 0}t:{var q="",H=(M=L(),B?/rv:([^\);]+)(\)|;)/.exec(M):V?/Edge\/([\d\.]+)/.exec(M):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(M):j?/WebKit\/(\S+)/.exec(M):P?/(?:Version)[ \/]?(\S+)/.exec(M):void 0);if(H&&(q=H?H[1]:""),F){var K=$();if(null!=K&&K>parseFloat(q)){x=String(K);break t}}x=q}var G,z={};function Q(){return function(t){var e=z;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let t=0;const e=N(String(x)).split("."),n=N("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var s=e[o]||"",r=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=k(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||k(0==s[2].length,0==r[2].length)||k(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t}()}()}u.document&&F?G=$()||parseInt(x,10)||void 0:G=void 0;var X=G;function W(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(B){t:{try{R(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Y[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&W.X.h.call(this)}}E(W,A);var Y={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var J="closure_listenable_"+(1e6*Math.random()|0),Z=0;function tt(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=s,this.key=++Z,this.ba=this.ea=!1}function et(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function nt(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function it(t){const e={};for(const n in t)e[n]=t[n];return e}const st="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<st.length;e++)n=st[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){this.src=t,this.g={},this.h=0}function at(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=T(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(et(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ct(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ba&&r.listener==e&&r.capture==!!n&&r.ha==i)return s}return-1}ot.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=ct(t,e,i,s);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new tt(e,this.src,r,!!i,s)).ea=n,t.push(e)),e};var lt="closure_lm_"+(1e6*Math.random()|0),ht={};function ut(t,e,n,i,s){if(i&&i.once)return dt(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)ut(t,e[r],n,i,s);return null}return n=bt(n),t&&t[J]?t.N(e,n,p(i)?!!i.capture:!!i,s):ft(t,e,n,!1,i,s)}function ft(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var o=p(s)?!!s.capture:!!s,a=vt(t);if(a||(t[lt]=a=new ot(t)),(n=a.add(e,n,i,o,r)).proxy)return n;if(i=function(){const t=yt;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)D||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(mt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function dt(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)dt(t,e[r],n,i,s);return null}return n=bt(n),t&&t[J]?t.O(e,n,p(i)?!!i.capture:!!i,s):ft(t,e,n,!0,i,s)}function pt(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)pt(t,e[r],n,i,s);else i=p(i)?!!i.capture:!!i,n=bt(n),t&&t[J]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=ct(r=t.g[e],n,i,s))&&(et(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=vt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ct(e,n,i,s)),(n=-1<t?e[t]:null)&&gt(n))}function gt(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[J])at(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(mt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=vt(e))?(at(n,t),0==n.h&&(n.src=null,e[lt]=null)):et(t)}}}function mt(t){return t in ht?ht[t]:ht[t]="on"+t}function yt(t,e){if(t.ba)t=!0;else{e=new W(e,this);var n=t.listener,i=t.ha||t.src;t.ea&&gt(t),t=n.call(i,e)}return t}function vt(t){return(t=t[lt])instanceof ot?t:null}var wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function bt(t){return"function"==typeof t?t:(t[wt]||(t[wt]=function(e){return t.handleEvent(e)}),t[wt])}function Et(){I.call(this),this.i=new ot(this),this.P=this,this.I=null}function It(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new A(e,t);else if(e instanceof A)e.target=e.target||t;else{var s=e;rt(e=new A(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];s=Tt(o,i,!0,e)&&s}if(s=Tt(o=e.g=t,i,!0,e)&&s,s=Tt(o,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=Tt(o=e.g=n[r],i,!1,e)&&s}function Tt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&at(t.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}E(Et,I),Et.prototype[J]=!0,Et.prototype.removeEventListener=function(t,e,n,i){pt(this,t,e,n,i)},Et.prototype.M=function(){if(Et.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)et(n[i]);delete e.g[t],e.h--}}this.I=null},Et.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Et.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var St=u.JSON.stringify;function Ct(){var t=Ot;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var At,Dt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new _t),(t=>t.reset()));class _t{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Nt(t){u.setTimeout((()=>{throw t}),0)}function kt(t,e){At||function(){var t=u.Promise.resolve(void 0);At=function(){t.then(Rt)}}(),Lt||(At(),Lt=!0),Ot.add(t,e)}var Lt=!1,Ot=new class{constructor(){this.h=this.g=null}add(t,e){const n=Dt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Rt(){for(var t;t=Ct();){try{t.h.call(t.g)}catch(t){Nt(t)}var e=Dt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Lt=!1}function xt(t,e){Et.call(this),this.h=t||1,this.g=e||u,this.j=w(this.lb,this),this.l=Date.now()}function Mt(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function Pt(t,e,n){if("function"==typeof t)n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function Ft(t){t.g=Pt((()=>{t.g=null,t.i&&(t.i=!1,Ft(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}E(xt,Et),(i=xt.prototype).ca=!1,i.R=null,i.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),It(this,"tick"),this.ca&&(Mt(this),this.start()))}},i.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},i.M=function(){xt.X.M.call(this),Mt(this),delete this.g};class Vt extends I{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ft(this)}M(){super.M(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ut(t){I.call(this),this.h=t,this.g={}}E(Ut,I);var Bt=[];function jt(t,e,n,i){Array.isArray(n)||(n&&(Bt[0]=n.toString()),n=Bt);for(var s=0;s<n.length;s++){var r=ut(e,n[s],i||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function $t(t){nt(t.g,(function(t,e){this.g.hasOwnProperty(e)&&gt(t)}),t),t.g={}}function qt(){this.g=!0}function Ht(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return St(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Ut.prototype.M=function(){Ut.X.M.call(this),$t(this)},Ut.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},qt.prototype.Aa=function(){this.g=!1},qt.prototype.info=function(){};var Kt={},Gt=null;function zt(){return Gt=Gt||new Et}function Qt(t){A.call(this,Kt.Pa,t)}function Xt(t){const e=zt();It(e,new Qt(e))}function Wt(t,e){A.call(this,Kt.STAT_EVENT,t),this.stat=e}function Yt(t){const e=zt();It(e,new Wt(e,t))}function Jt(t,e){A.call(this,Kt.Qa,t),this.size=e}function Zt(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return u.setTimeout((function(){t()}),e)}Kt.Pa="serverreachability",E(Qt,A),Kt.STAT_EVENT="statevent",E(Wt,A),Kt.Qa="timingevent",E(Jt,A);var te={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},ee={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function ne(){}function ie(t){return t.h||(t.h=t.i())}function se(){}ne.prototype.h=null;var re,oe={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function ae(){A.call(this,"d")}function ce(){A.call(this,"c")}function le(){}function he(t,e,n,i){this.l=t,this.j=e,this.m=n,this.U=i||1,this.S=new Ut(this),this.O=fe,t=U?125:void 0,this.T=new xt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new ue}function ue(){this.i=null,this.g="",this.h=!1}E(ae,A),E(ce,A),E(le,ne),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},re=new le;var fe=45e3,de={},pe={};function ge(t,e,n){t.K=1,t.v=xe(Ne(e)),t.s=n,t.P=!0,me(t,null)}function me(t,e){t.F=Date.now(),be(t),t.A=Ne(t.v);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),ze(n.i,"t",i),t.C=0,n=t.l.H,t.h=new ue,t.g=zn(t.l,n?e:null,!t.s),0<t.N&&(t.L=new Vt(w(t.La,t,t.g),t.N)),jt(t.S,t.g,"readystatechange",t.ib),e=t.H?it(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Xt(),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");o=2<=u.length&&"type"==u[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.U,t.s)}function ye(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Da}function ve(t,e,n){let i,s=!0;for(;!t.I&&t.C<n.length;){if(i=we(t,n),i==pe){4==e&&(t.o=4,Yt(14),s=!1),Ht(t.j,t.m,null,"[Incomplete Response]");break}if(i==de){t.o=4,Yt(15),Ht(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}Ht(t.j,t.m,i,null),Ce(t,i)}ye(t)&&i!=pe&&i!=de&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Yt(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Un(e),e.K=!0,Yt(11))):(Ht(t.j,t.m,n,"[Invalid Chunked Response]"),Se(t),Te(t))}function we(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?pe:(n=Number(e.substring(n,i)),isNaN(n)?de:(i+=1)+n>e.length?pe:(e=e.substr(i,n),t.C=i+n,e))}function be(t){t.V=Date.now()+t.O,Ee(t,t.O)}function Ee(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Zt(w(t.gb,t),e)}function Ie(t){t.B&&(u.clearTimeout(t.B),t.B=null)}function Te(t){0==t.l.G||t.I||$n(t.l,t)}function Se(t){Ie(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Mt(t.T),$t(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ce(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Ze(n.h,t)))if(!t.J&&Ze(n.h,t)&&3==n.G){try{var i=n.Fa.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;jn(n),Ln(n)}Vn(n),Yt(18)}}else n.Ba=s[1],0<n.Ba-n.T&&37500>s[2]&&n.L&&0==n.A&&!n.v&&(n.v=Zt(w(n.cb,n),6e3));if(1>=Je(n.h)&&n.ja){try{n.ja()}catch(t){}n.ja=void 0}}else Hn(n,11)}else if((t.J||n.g==t)&&jn(n),!_(e))for(s=n.Fa.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.I=l[1],n.ka=l[2];const e=l[3];null!=e&&(n.ma=e,n.j.info("VER="+n.ma));const s=l[4];null!=s&&(n.Ca=s,n.j.info("SVER="+n.Ca));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.J=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.h;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(tn(r,r.h),r.h=null))}if(i.D){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.za=t,Re(i.F,i.D,t))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((i=n).sa=Gn(i,i.H?i.ka:null,i.V),o.J){en(i.h,o);var a=o,c=i.J;c&&a.setTimeout(c),a.B&&(Ie(a),be(a)),i.g=o}else Fn(i);0<n.i.length&&Rn(n)}else"stop"!=l[0]&&"close"!=l[0]||Hn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Hn(n,7):kn(n):"noop"!=l[0]&&n.l&&n.l.wa(l),n.A=0)}Xt()}catch(t){}}function Ae(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length,r=0;r<s;r++)e.call(void 0,i[r],n&&n[r],t)}(i=he.prototype).setTimeout=function(t){this.O=t},i.ib=function(t){t=t.target;const e=this.L;e&&3==Sn(t)?e.l():this.La(t)},i.La=function(t){try{if(t==this.g)t:{const h=Sn(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>h)&&(3!=h||U||this.g&&(this.h.h||this.g.fa()||Cn(this.g)))){this.I||4!=h||7==e||Xt(),Ie(this);var n=this.g.aa();this.Y=n;e:if(ye(this)){var i=Cn(this.g);t="";var s=i.length,r=4==Sn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Se(this),Te(this);var o="";break e}this.h.i=new u.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(t,e,n,i,s,r,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.U,h,n),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,Yt(12),Se(this),Te(this);break t}Ht(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ce(this,n)}this.P?(ve(this,h,o),U&&this.i&&3==h&&(jt(this.S,this.T,"tick",this.hb),this.T.start())):(Ht(this.j,this.m,o,null),Ce(this,o)),4==h&&Se(this),this.i&&!this.I&&(4==h?$n(this.l,this):(this.i=!1,be(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Yt(12)):(this.o=0,Yt(13)),Se(this),Te(this)}}}catch(t){}},i.hb=function(){if(this.g){var t=Sn(this.g),e=this.g.fa();this.C<e.length&&(Ie(this),ve(this,t,e),this.i&&4!=t&&be(this))}},i.cancel=function(){this.I=!0,Se(this)},i.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Xt(),Yt(17)),Se(this),this.o=2,Te(this)):Ee(this,this.V-t)};var De=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _e(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof _e){this.h=void 0!==e?e:t.h,ke(this,t.j),this.s=t.s,this.g=t.g,Le(this,t.m),this.l=t.l,e=t.i;var n=new qe;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Oe(this,n),this.o=t.o}else t&&(n=String(t).match(De))?(this.h=!!e,ke(this,n[1]||"",!0),this.s=Me(n[2]||""),this.g=Me(n[3]||"",!0),Le(this,n[4]),this.l=Me(n[5]||"",!0),Oe(this,n[6]||"",!0),this.o=Me(n[7]||"")):(this.h=!!e,this.i=new qe(null,this.h))}function Ne(t){return new _e(t)}function ke(t,e,n){t.j=n?Me(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Le(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Oe(t,e,n){e instanceof qe?(t.i=e,function(t,e){e&&!t.j&&(He(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ke(this,e),ze(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Pe(e,je)),t.i=new qe(e,t.h))}function Re(t,e,n){t.i.set(e,n)}function xe(t){return Re(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Me(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Pe(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Fe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Fe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}_e.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Pe(e,Ve,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Pe(e,Ve,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Pe(n,"/"==n.charAt(0)?Be:Ue,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Pe(n,$e)),t.join("")};var Ve=/[#\/\?@]/g,Ue=/[#\?:]/g,Be=/[#\?]/g,je=/[#\?@]/g,$e=/#/g;function qe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function He(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ke(t,e){He(t),e=Qe(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ge(t,e){return He(t),e=Qe(t,e),t.g.has(e)}function ze(t,e,n){Ke(t,e),0<n.length&&(t.i=null,t.g.set(Qe(t,e),S(n)),t.h+=n.length)}function Qe(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Xe(t){this.l=t||We,t=u.PerformanceNavigationTiming?0<(t=u.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(u.g&&u.g.Ga&&u.g.Ga()&&u.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(i=qe.prototype).add=function(t,e){He(this),this.i=null,t=Qe(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},i.forEach=function(t,e){He(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},i.oa=function(){He(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const s=t[i];for(let t=0;t<s.length;t++)n.push(e[i])}return n},i.W=function(t){He(this);let e=[];if("string"==typeof t)Ge(this,t)&&(e=e.concat(this.g.get(Qe(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},i.set=function(t,e){return He(this),this.i=null,Ge(this,t=Qe(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},i.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const r=encodeURIComponent(String(i)),o=this.W(i);for(i=0;i<o.length;i++){var s=r;""!==o[i]&&(s+="="+encodeURIComponent(String(o[i]))),t.push(s)}}return this.i=t.join("&")};var We=10;function Ye(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Je(t){return t.h?1:t.g?t.g.size:0}function Ze(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function tn(t,e){t.g?t.g.add(e):t.h=e}function en(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function nn(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return S(t.i)}function sn(){}function rn(){this.g=new sn}function on(t,e,n){const i=n||"";try{Ae(t,(function(t,n){let s=t;p(t)&&(s=St(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function an(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(t){}}function cn(t){this.l=t.ac||null,this.j=t.jb||!1}function ln(t,e){Et.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=hn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Xe.prototype.cancel=function(){if(this.i=nn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},sn.prototype.stringify=function(t){return u.JSON.stringify(t,void 0)},sn.prototype.parse=function(t){return u.JSON.parse(t,void 0)},E(cn,ne),cn.prototype.g=function(){return new ln(this.l,this.j)},cn.prototype.i=function(t){return function(){return t}}({}),E(ln,Et);var hn=0;function un(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function fn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,dn(t)}function dn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(i=ln.prototype).open=function(t,e){if(this.readyState!=hn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,dn(this)},i.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||u).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fn(this)),this.readyState=hn},i.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,dn(this)),this.g&&(this.readyState=3,dn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==u.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;un(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},i.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?fn(this):dn(this),3==this.readyState&&un(this)}},i.Va=function(t){this.g&&(this.response=this.responseText=t,fn(this))},i.Ua=function(t){this.g&&(this.response=t,fn(this))},i.ga=function(){this.g&&fn(this)},i.setRequestHeader=function(t,e){this.v.append(t,e)},i.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ln.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var pn=u.JSON.parse;function gn(t){Et.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=mn,this.K=this.L=!1}E(gn,Et);var mn="",yn=/^https?$/i,vn=["POST","PUT"];function wn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bn(t),In(t)}function bn(t){t.D||(t.D=!0,It(t,"complete"),It(t,"error"))}function En(t){if(t.h&&void 0!==h&&(!t.C[1]||4!=Sn(t)||2!=t.aa()))if(t.v&&4==Sn(t))Pt(t.Ha,0,t);else if(It(t,"readystatechange"),4==Sn(t)){t.h=!1;try{const a=t.aa();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===a){var s=String(t.H).match(De)[1]||null;if(!s&&u.self&&u.self.location){var r=u.self.location.protocol;s=r.substr(0,r.length-1)}i=!yn.test(s?s.toLowerCase():"")}n=i}if(n)It(t,"complete"),It(t,"success");else{t.m=6;try{var o=2<Sn(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.aa()+"]",bn(t)}}finally{In(t)}}}function In(t,e){if(t.g){Tn(t);const n=t.g,i=t.C[0]?f:null;t.g=null,t.C=null,e||It(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Tn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(u.clearTimeout(t.A),t.A=null)}function Sn(t){return t.g?t.g.readyState:0}function Cn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case mn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function An(t){let e="";return nt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Dn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=An(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Re(t,e,n))}function _n(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Nn(t){this.Ca=0,this.i=[],this.j=new qt,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=_n("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=_n("baseRetryDelayMs",5e3,t),this.bb=_n("retryDelaySeedMs",1e4,t),this.$a=_n("forwardChannelMaxRetries",2,t),this.ta=_n("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Xe(t&&t.concurrentRequestLimit),this.Fa=new rn,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function kn(t){if(On(t),3==t.G){var e=t.U++,n=Ne(t.F);Re(n,"SID",t.I),Re(n,"RID",e),Re(n,"TYPE","terminate"),Mn(t,n),(e=new he(t,t.j,e,void 0)).K=2,e.v=xe(Ne(n)),n=!1,u.navigator&&u.navigator.sendBeacon&&(n=u.navigator.sendBeacon(e.v.toString(),"")),!n&&u.Image&&((new Image).src=e.v,n=!0),n||(e.g=zn(e.l,null),e.g.da(e.v)),e.F=Date.now(),be(e)}Kn(t)}function Ln(t){t.g&&(Un(t),t.g.cancel(),t.g=null)}function On(t){Ln(t),t.u&&(u.clearTimeout(t.u),t.u=null),jn(t),t.h.cancel(),t.m&&("number"==typeof t.m&&u.clearTimeout(t.m),t.m=null)}function Rn(t){Ye(t.h)||t.m||(t.m=!0,kt(t.Ja,t),t.C=0)}function xn(t,e){var n;n=e?e.m:t.U++;const i=Ne(t.F);Re(i,"SID",t.I),Re(i,"RID",n),Re(i,"AID",t.T),Mn(t,i),t.o&&t.s&&Dn(i,t.o,t.s),n=new he(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Pn(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),tn(t.h,n),ge(n,i,e)}function Mn(t,e){t.ia&&nt(t.ia,(function(t,n){Re(e,n,t)})),t.l&&Ae({},(function(t,n){Re(e,n,t)}))}function Pn(t,e,n){n=Math.min(t.i.length,n);var i=t.l?w(t.l.Ra,t.l,t):null;t:{var s=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let o=0;o<n;o++){let n=s[o].h;const a=s[o].g;if(n-=e,0>n)e=Math.max(0,s[o].h-100),r=!1;else try{on(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(r){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function Fn(t){t.g||t.u||(t.Z=1,kt(t.Ia,t),t.A=0)}function Vn(t){return!(t.g||t.u||3<=t.A||(t.Z++,t.u=Zt(w(t.Ia,t),qn(t,t.A)),t.A++,0))}function Un(t){null!=t.B&&(u.clearTimeout(t.B),t.B=null)}function Bn(t){t.g=new he(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=Ne(t.sa);Re(e,"RID","rpc"),Re(e,"SID",t.I),Re(e,"CI",t.L?"0":"1"),Re(e,"AID",t.T),Re(e,"TYPE","xmlhttp"),Mn(t,e),t.o&&t.s&&Dn(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=xe(Ne(e)),n.s=null,n.P=!0,me(n,t)}function jn(t){null!=t.v&&(u.clearTimeout(t.v),t.v=null)}function $n(t,e){var n=null;if(t.g==e){jn(t),Un(t),t.g=null;var i=2}else{if(!Ze(t.h,e))return;n=e.D,en(t.h,e),i=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;It(i=zt(),new Jt(i,n)),Rn(t)}else Fn(t);else if(3==(s=e.o)||0==s&&0<t.pa||!(1==i&&function(t,e){return!(Je(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.C>=(t.Za?0:t.$a)||(t.m=Zt(w(t.Ja,t,e),qn(t,t.C)),t.C++,0)))}(t,e)||2==i&&Vn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),s){case 1:Hn(t,5);break;case 4:Hn(t,10);break;case 3:Hn(t,6);break;default:Hn(t,2)}}function qn(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function Hn(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var i=w(t.kb,t);n||(n=new _e("//www.google.com/images/cleardot.gif"),u.location&&"http"==u.location.protocol||ke(n,"https"),xe(n)),function(t,e){const n=new qt;if(u.Image){const i=new Image;i.onload=b(an,n,i,"TestLoadImage: loaded",!0,e),i.onerror=b(an,n,i,"TestLoadImage: error",!1,e),i.onabort=b(an,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=b(an,n,i,"TestLoadImage: timeout",!1,e),u.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Yt(2);t.G=0,t.l&&t.l.va(e),Kn(t),On(t)}function Kn(t){if(t.G=0,t.la=[],t.l){const e=nn(t.h);0==e.length&&0==t.i.length||(C(t.la,e),C(t.la,t.i),t.h.i.length=0,S(t.i),t.i.length=0),t.l.ua()}}function Gn(t,e,n){var i=n instanceof _e?Ne(n):new _e(n,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),Le(i,i.m);else{var s=u.location;i=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var r=new _e(null,void 0);i&&ke(r,i),e&&(r.g=e),s&&Le(r,s),n&&(r.l=n),i=r}return n=t.D,e=t.za,n&&e&&Re(i,n,e),Re(i,"VER",t.ma),Mn(t,i),i}function zn(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Da&&!t.ra?new gn(new cn({jb:!0})):new gn(t.ra)).Ka(t.H),e}function Qn(){}function Xn(){if(F&&!(10<=Number(X)))throw Error("Environmental error: no available transport.")}function Wn(t,e){Et.call(this),this.g=new Nn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!_(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!_(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Zn(this)}function Yn(t){ae.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Jn(){ce.call(this),this.status=1}function Zn(t){this.g=t}(i=gn.prototype).Ka=function(t){this.L=t},i.da=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():re.g(),this.C=this.u?ie(this.u):ie(re),this.g.onreadystatechange=w(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void wn(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),s=u.FormData&&t instanceof u.FormData,!(0<=T(vn,e))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Tn(this),0<this.B&&((this.K=function(t){return F&&Q()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=w(this.qa,this)):this.A=Pt(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){wn(this,t)}},i.qa=function(){void 0!==h&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,It(this,"timeout"),this.abort(8))},i.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,It(this,"complete"),It(this,"abort"),In(this))},i.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),In(this,!0)),gn.X.M.call(this)},i.Ha=function(){this.s||(this.F||this.v||this.l?En(this):this.fb())},i.fb=function(){En(this)},i.aa=function(){try{return 2<Sn(this)?this.g.status:-1}catch(t){return-1}},i.fa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},i.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),pn(e)}},i.Ea=function(){return this.m},i.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(i=Nn.prototype).ma=8,i.G=1,i.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new he(this,this.j,t,void 0);let r=this.s;if(this.S&&(r?(r=it(r),rt(r,this.S)):r=this.S),null!==this.o||this.N||(s.H=r,r=null),this.O)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Pn(this,s,e),Re(n=Ne(this.F),"RID",t),Re(n,"CVER",22),this.D&&Re(n,"X-HTTP-Session-Id",this.D),Mn(this,n),r&&(this.N?e="headers="+encodeURIComponent(String(An(r)))+"&"+e:this.o&&Dn(n,this.o,r)),tn(this.h,s),this.Ya&&Re(n,"TYPE","init"),this.O?(Re(n,"$req",e),Re(n,"SID","null"),s.Z=!0,ge(s,n,null)):ge(s,n,e),this.G=2}}else 3==this.G&&(t?xn(this,t):0==this.i.length||Ye(this.h)||xn(this))},i.Ia=function(){if(this.u=null,Bn(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=Zt(w(this.eb,this),t)}},i.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Yt(10),Ln(this),Bn(this))},i.cb=function(){null!=this.v&&(this.v=null,Ln(this),Vn(this),Yt(19))},i.kb=function(t){t?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))},(i=Qn.prototype).xa=function(){},i.wa=function(){},i.va=function(){},i.ua=function(){},i.Ra=function(){},Xn.prototype.g=function(t,e){return new Wn(t,e)},E(Wn,Et),Wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;Yt(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=Gn(t,null,t.V),Rn(t)},Wn.prototype.close=function(){kn(this.g)},Wn.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=St(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&Rn(e)},Wn.prototype.M=function(){this.g.l=null,delete this.j,kn(this.g),delete this.g,Wn.X.M.call(this)},E(Yn,ae),E(Jn,ce),E(Zn,Qn),Zn.prototype.xa=function(){It(this.g,"a")},Zn.prototype.wa=function(t){It(this.g,new Yn(t))},Zn.prototype.va=function(t){It(this.g,new Jn)},Zn.prototype.ua=function(){It(this.g,"b")},Xn.prototype.createWebChannel=Xn.prototype.g,Wn.prototype.send=Wn.prototype.u,Wn.prototype.open=Wn.prototype.m,Wn.prototype.close=Wn.prototype.close,te.NO_ERROR=0,te.TIMEOUT=8,te.HTTP_ERROR=6,ee.COMPLETE="complete",se.EventType=oe,oe.OPEN="a",oe.CLOSE="b",oe.ERROR="c",oe.MESSAGE="d",Et.prototype.listen=Et.prototype.N,gn.prototype.listenOnce=gn.prototype.O,gn.prototype.getLastError=gn.prototype.Oa,gn.prototype.getLastErrorCode=gn.prototype.Ea,gn.prototype.getStatus=gn.prototype.aa,gn.prototype.getResponseJson=gn.prototype.Sa,gn.prototype.getResponseText=gn.prototype.fa,gn.prototype.send=gn.prototype.da,gn.prototype.setWithCredentials=gn.prototype.Ka;var ti=l.createWebChannelTransport=function(){return new Xn},ei=l.getStatEventTarget=function(){return zt()},ni=l.ErrorCode=te,ii=l.EventType=ee,si=l.Event=Kt,ri=l.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},oi=l.FetchXmlHttpFactory=cn,ai=l.WebChannel=se,ci=l.XhrIo=gn;const li="@firebase/firestore";class hi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}hi.UNAUTHENTICATED=new hi(null),hi.GOOGLE_CREDENTIALS=new hi("google-credentials-uid"),hi.FIRST_PARTY=new hi("first-party-uid"),hi.MOCK_USER=new hi("mock-user");let ui="9.17.1";const fi=new o.Yd("@firebase/firestore");function di(){return fi.logLevel}function pi(t,...e){if(fi.logLevel<=o.in.DEBUG){const n=e.map(yi);fi.debug(`Firestore (${ui}): ${t}`,...n)}}function gi(t,...e){if(fi.logLevel<=o.in.ERROR){const n=e.map(yi);fi.error(`Firestore (${ui}): ${t}`,...n)}}function mi(t,...e){if(fi.logLevel<=o.in.WARN){const n=e.map(yi);fi.warn(`Firestore (${ui}): ${t}`,...n)}}function yi(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function vi(t="Unexpected state"){const e=`FIRESTORE (${ui}) INTERNAL ASSERTION FAILED: `+t;throw gi(e),new Error(e)}function wi(t,e){t||vi()}function bi(t,e){return t}const Ei={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ii extends a.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ti{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Si{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Ci{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(hi.UNAUTHENTICATED)))}shutdown(){}}class Ai{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Di{constructor(t){this.t=t,this.currentUser=hi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new Ti;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ti,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{pi("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(pi("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ti)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(pi("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(wi("string"==typeof e.accessToken),new Si(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return wi(null===t||"string"==typeof t),new hi(t)}}class _i{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i,this.type="FirstParty",this.user=hi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(wi(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Ni{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i}getToken(){return Promise.resolve(new _i(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable((()=>e(hi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ki{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Li{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&pi("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.A;return this.A=t.token,pi("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{pi("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?i(t):pi("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(wi("string"==typeof t.token),this.A=t.token,new ki(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Oi(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Ri{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=Oi(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<e&&(n+=t.charAt(i[s]%t.length))}return n}}function xi(t,e){return t<e?-1:t>e?1:0}function Mi(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Pi{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ii(Ei.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ii(Ei.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ii(Ei.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ii(Ei.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Pi.fromMillis(Date.now())}static fromDate(t){return Pi.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Pi(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?xi(this.nanoseconds,t.nanoseconds):xi(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Fi{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Fi(t)}static min(){return new Fi(new Pi(0,0))}static max(){return new Fi(new Pi(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Vi{constructor(t,e,n){void 0===e?e=0:e>t.length&&vi(),void 0===n?n=t.length-e:n>t.length-e&&vi(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Vi.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Vi?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Ui extends Vi{construct(t,e,n){return new Ui(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ii(Ei.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Ui(e)}static emptyPath(){return new Ui([])}}const Bi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ji extends Vi{construct(t,e,n){return new ji(t,e,n)}static isValidIdentifier(t){return Bi.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ji.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ji(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Ii(Ei.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Ii(Ei.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Ii(Ei.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new Ii(Ei.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ji(e)}static emptyPath(){return new ji([])}}class $i{constructor(t){this.path=t}static fromPath(t){return new $i(Ui.fromString(t))}static fromName(t){return new $i(Ui.fromString(t).popFirst(5))}static empty(){return new $i(Ui.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Ui.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Ui.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new $i(new Ui(t.slice()))}}function qi(t){return new Hi(t.readTime,t.key,-1)}class Hi{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Hi(Fi.min(),$i.empty(),-1)}static max(){return new Hi(Fi.max(),$i.empty(),-1)}}function Ki(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=$i.comparator(t.documentKey,e.documentKey),0!==n?n:xi(t.largestBatchId,e.largestBatchId))}const Gi="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zi{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Qi(t){if(t.code!==Ei.FAILED_PRECONDITION||t.message!==Gi)throw t;pi("LocalStore","Unexpectedly lost primary lease")}class Xi{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&vi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Xi(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Xi?e:Xi.resolve(e)}catch(t){return Xi.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Xi.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Xi.reject(e)}static resolve(t){return new Xi(((e,n)=>{e(t)}))}static reject(t){return new Xi(((e,n)=>{n(t)}))}static waitFor(t){return new Xi(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=Xi.resolve(!1);for(const n of t)e=e.next((t=>t?Xi.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Xi(((n,i)=>{const s=t.length,r=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===s&&n(r)}),(t=>i(t)))}}))}static doWhile(t,e){return new Xi(((n,i)=>{const s=()=>{!0===t()?e().next((()=>{s()}),i):n()};s()}))}}function Wi(t){return"IndexedDbTransactionError"===t.name}class Yi{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}Yi.at=-1;class Ji{constructor(t,e,n,i,s,r,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Zi{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Zi("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Zi&&t.projectId===this.projectId&&t.database===this.database}}function ts(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function es(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ns(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function is(t){return null==t}function ss(t){return 0===t&&1/t==-1/0}class rs{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new rs(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new rs(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return xi(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}rs.EMPTY_BYTE_STRING=new rs("");const os=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function as(t){if(wi(!!t),"string"==typeof t){let e=0;const n=os.exec(t);if(wi(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:cs(t.seconds),nanos:cs(t.nanos)}}function cs(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ls(t){return"string"==typeof t?rs.fromBase64String(t):rs.fromUint8Array(t)}function hs(t){const e=as(t.mapValue.fields.__local_write_time__.timestampValue);return new Pi(e.seconds,e.nanos)}const us={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?function(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(t)?4:Ts(t)?9007199254740991:10:vi()}function ds(t,e){if(t===e)return!0;const n=fs(t);if(n!==fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return hs(t).isEqual(hs(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=as(t.timestampValue),i=as(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ls(t.bytesValue).isEqual(ls(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return cs(t.geoPointValue.latitude)===cs(e.geoPointValue.latitude)&&cs(t.geoPointValue.longitude)===cs(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return cs(t.integerValue)===cs(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=cs(t.doubleValue),i=cs(e.doubleValue);return n===i?ss(n)===ss(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Mi(t.arrayValue.values||[],e.arrayValue.values||[],ds);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(ts(n)!==ts(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!ds(n[t],i[t])))return!1;return!0}(t,e);default:return vi()}}function ps(t,e){return void 0!==(t.values||[]).find((t=>ds(t,e)))}function gs(t,e){if(t===e)return 0;const n=fs(t),i=fs(e);if(n!==i)return xi(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return xi(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=cs(t.integerValue||t.doubleValue),i=cs(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return ms(t.timestampValue,e.timestampValue);case 4:return ms(hs(t),hs(e));case 5:return xi(t.stringValue,e.stringValue);case 6:return function(t,e){const n=ls(t),i=ls(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=xi(n[t],i[t]);if(0!==e)return e}return xi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=xi(cs(t.latitude),cs(e.latitude));return 0!==n?n:xi(cs(t.longitude),cs(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=gs(n[t],i[t]);if(e)return e}return xi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===us.mapValue&&e===us.mapValue)return 0;if(t===us.mapValue)return 1;if(e===us.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let t=0;t<i.length&&t<r.length;++t){const e=xi(i[t],r[t]);if(0!==e)return e;const o=gs(n[i[t]],s[r[t]]);if(0!==o)return o}return xi(i.length,r.length)}(t.mapValue,e.mapValue);default:throw vi()}}function ms(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xi(t,e);const n=as(t),i=as(e),s=xi(n.seconds,i.seconds);return 0!==s?s:xi(n.nanos,i.nanos)}function ys(t){return vs(t)}function vs(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=as(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ls(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,$i.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=vs(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${vs(t.fields[s])}`;return n+"}"}(t.mapValue):vi();var e,n}function ws(t){return!!t&&"integerValue"in t}function bs(t){return!!t&&"arrayValue"in t}function Es(t){return!!t&&"mapValue"in t}function Is(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return es(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Is(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Is(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ts(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Ss{constructor(t,e){this.position=t,this.inclusive=e}}function Cs(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],o=t.position[s];if(i=r.field.isKeyField()?$i.comparator($i.fromName(o.referenceValue),n.key):gs(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function As(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ds(t.position[n],e.position[n]))return!1;return!0}class Ds{}class _s extends Ds{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Ms(t,e,n):"array-contains"===e?new Us(t,n):"in"===e?new Bs(t,n):"not-in"===e?new js(t,n):"array-contains-any"===e?new $s(t,n):new _s(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Ps(t,n):new Fs(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(gs(e,this.value)):null!==e&&fs(this.value)===fs(e)&&this.matchesComparison(gs(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return vi()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Ns extends Ds{constructor(t,e){super(),this.filters=t,this.op=e,this.ht=null}static create(t,e){return new Ns(t,e)}matches(t){return ks(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.lt((t=>t.isInequality()));return null!==t?t.field:null}lt(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function ks(t){return"and"===t.op}function Ls(t){return function(t){for(const e of t.filters)if(e instanceof Ns)return!1;return!0}(t)&&ks(t)}function Os(t){if(t instanceof _s)return t.field.canonicalString()+t.op.toString()+ys(t.value);if(Ls(t))return t.filters.map((t=>Os(t))).join(",");{const e=t.filters.map((t=>Os(t))).join(",");return`${t.op}(${e})`}}function Rs(t,e){return t instanceof _s?function(t,e){return e instanceof _s&&t.op===e.op&&t.field.isEqual(e.field)&&ds(t.value,e.value)}(t,e):t instanceof Ns?function(t,e){return e instanceof Ns&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Rs(n,e.filters[i])),!0)}(t,e):void vi()}function xs(t){return t instanceof _s?function(t){return`${t.field.canonicalString()} ${t.op} ${ys(t.value)}`}(t):t instanceof Ns?function(t){return t.op.toString()+" {"+t.getFilters().map(xs).join(" ,")+"}"}(t):"Filter"}class Ms extends _s{constructor(t,e,n){super(t,e,n),this.key=$i.fromName(n.referenceValue)}matches(t){const e=$i.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ps extends _s{constructor(t,e){super(t,"in",e),this.keys=Vs(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Fs extends _s{constructor(t,e){super(t,"not-in",e),this.keys=Vs(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Vs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>$i.fromName(t.referenceValue)))}class Us extends _s{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return bs(e)&&ps(e.arrayValue,this.value)}}class Bs extends _s{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&ps(this.value.arrayValue,e)}}class js extends _s{constructor(t,e){super(t,"not-in",e)}matches(t){if(ps(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!ps(this.value.arrayValue,e)}}class $s extends _s{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!bs(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>ps(this.value.arrayValue,t)))}}class qs{constructor(t,e="asc"){this.field=t,this.dir=e}}function Hs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Ks{constructor(t,e){this.comparator=t,this.root=e||zs.EMPTY}insert(t,e){return new Ks(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,zs.BLACK,null,null))}remove(t){return new Ks(this.comparator,this.root.remove(t,this.comparator).copy(null,null,zs.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gs(this.root,t,this.comparator,!0)}}class Gs{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class zs{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:zs.RED,this.left=null!=i?i:zs.EMPTY,this.right=null!=s?s:zs.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new zs(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zs.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return zs.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,zs.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,zs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw vi();if(this.right.isRed())throw vi();const t=this.left.check();if(t!==this.right.check())throw vi();return t+(this.isRed()?0:1)}}zs.EMPTY=null,zs.RED=!0,zs.BLACK=!1,zs.EMPTY=new class{constructor(){this.size=0}get key(){throw vi()}get value(){throw vi()}get color(){throw vi()}get left(){throw vi()}get right(){throw vi()}copy(t,e,n,i,s){return this}insert(t,e,n){return new zs(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qs{constructor(t){this.comparator=t,this.data=new Ks(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Xs(this.data.getIterator())}getIteratorFrom(t){return new Xs(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Qs))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Qs(this.comparator);return e.data=t,e}}class Xs{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ws{constructor(t){this.fields=t,t.sort(ji.comparator)}static empty(){return new Ws([])}unionWith(t){let e=new Qs(ji.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Ws(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Mi(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Ys{constructor(t){this.value=t}static empty(){return new Ys({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Es(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Is(e)}setAll(t){let e=ji.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=Is(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());Es(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ds(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Es(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){es(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Ys(Is(this.value))}}function Js(t){const e=[];return es(t.fields,((t,n)=>{const i=new ji([t]);if(Es(n)){const t=Js(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Ws(e)}class Zs{constructor(t,e,n,i,s,r,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=s,this.data=r,this.documentState=o}static newInvalidDocument(t){return new Zs(t,0,Fi.min(),Fi.min(),Fi.min(),Ys.empty(),0)}static newFoundDocument(t,e,n,i){return new Zs(t,1,e,Fi.min(),n,i,0)}static newNoDocument(t,e){return new Zs(t,2,e,Fi.min(),Fi.min(),Ys.empty(),0)}static newUnknownDocument(t,e){return new Zs(t,3,e,Fi.min(),Fi.min(),Ys.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Fi.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ys.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ys.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fi.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Zs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Zs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class tr{constructor(t,e=null,n=[],i=[],s=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.ft=null}}function er(t,e=null,n=[],i=[],s=null,r=null,o=null){return new tr(t,e,n,i,s,r,o)}function nr(t){const e=bi(t);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Os(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),is(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>ys(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>ys(t))).join(",")),e.ft=t}return e.ft}function ir(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Hs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Rs(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!As(t.startAt,e.startAt)&&As(t.endAt,e.endAt)}class sr{constructor(t,e=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this.dt=null,this._t=null,this.startAt,this.endAt}}function rr(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function or(t){const e=bi(t);if(null===e.dt){e.dt=[];const t=function(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.dt.push(new qs(t)),e.dt.push(new qs(ji.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.dt.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new qs(ji.keyField(),t))}}}return e.dt}function ar(t){const e=bi(t);if(!e._t)if("F"===e.limitType)e._t=er(e.path,e.collectionGroup,or(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of or(e)){const e="desc"===n.dir?"asc":"desc";t.push(new qs(n.field,e))}const n=e.endAt?new Ss(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Ss(e.startAt.position,e.startAt.inclusive):null;e._t=er(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function cr(t,e,n){return new sr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lr(t,e){return ir(ar(t),ar(e))&&t.limitType===e.limitType}function hr(t){return`${nr(ar(t))}|lt:${t.limitType}`}function ur(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>xs(t))).join(", ")}]`),is(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>ys(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>ys(t))).join(",")),`Target(${e})`}(ar(t))}; limitType=${t.limitType})`}function fr(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):$i.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of or(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Cs(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,or(t),e)||t.endAt&&!function(t,e,n){const i=Cs(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,or(t),e))}(t,e)}function dr(t,e,n){const i=t.field.isKeyField()?$i.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?gs(i,s):vi()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return vi()}}function pr(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ss(e)?"-0":e}}function gr(t){return{integerValue:""+t}}function mr(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ss(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?gr(e):pr(t,e)}class yr{constructor(){this._=void 0}}function vr(t,e,n){return t instanceof Er?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ir?Tr(t,e):t instanceof Sr?Cr(t,e):function(t,e){const n=br(t,e),i=Dr(n)+Dr(t.gt);return ws(n)&&ws(t.gt)?gr(i):pr(t.yt,i)}(t,e)}function wr(t,e,n){return t instanceof Ir?Tr(t,e):t instanceof Sr?Cr(t,e):n}function br(t,e){return t instanceof Ar?ws(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Er extends yr{}class Ir extends yr{constructor(t){super(),this.elements=t}}function Tr(t,e){const n=_r(e);for(const e of t.elements)n.some((t=>ds(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Sr extends yr{constructor(t){super(),this.elements=t}}function Cr(t,e){let n=_r(e);for(const e of t.elements)n=n.filter((t=>!ds(t,e)));return{arrayValue:{values:n}}}class Ar extends yr{constructor(t,e){super(),this.yt=t,this.gt=e}}function Dr(t){return cs(t.integerValue||t.doubleValue)}function _r(t){return bs(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Nr{constructor(t,e){this.version=t,this.transformResults=e}}class kr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new kr}static exists(t){return new kr(void 0,t)}static updateTime(t){return new kr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Lr(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Or{}function Rr(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new qr(t.key,kr.none()):new Vr(t.key,t.data,kr.none());{const n=t.data,i=Ys.empty();let s=new Qs(ji.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),s=s.add(t)}return new Ur(t.key,i,new Ws(s.toArray()),kr.none())}}function xr(t,e,n){t instanceof Vr?function(t,e,n){const i=t.value.clone(),s=jr(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Ur?function(t,e,n){if(!Lr(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=jr(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(Br(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Mr(t,e,n,i){return t instanceof Vr?function(t,e,n,i){if(!Lr(t.precondition,e))return n;const s=t.value.clone(),r=$r(t.fieldTransforms,i,e);return s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,i):t instanceof Ur?function(t,e,n,i){if(!Lr(t.precondition,e))return n;const s=$r(t.fieldTransforms,i,e),r=e.data;return r.setAll(Br(t)),r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Lr(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Pr(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=br(i.transform,t||null);null!=s&&(null===n&&(n=Ys.empty()),n.set(i.field,s))}return n||null}function Fr(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Mi(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ir&&e instanceof Ir||t instanceof Sr&&e instanceof Sr?Mi(t.elements,e.elements,ds):t instanceof Ar&&e instanceof Ar?ds(t.gt,e.gt):t instanceof Er&&e instanceof Er}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Vr extends Or{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ur extends Or{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Br(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function jr(t,e,n){const i=new Map;wi(t.length===n.length);for(let s=0;s<n.length;s++){const r=t[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,wr(o,a,n[s]))}return i}function $r(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,vr(t,r,e))}return i}class qr extends Or{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hr extends Or{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}var Kr,Gr;(Gr=Kr||(Kr={}))[Gr.OK=0]="OK",Gr[Gr.CANCELLED=1]="CANCELLED",Gr[Gr.UNKNOWN=2]="UNKNOWN",Gr[Gr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gr[Gr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gr[Gr.NOT_FOUND=5]="NOT_FOUND",Gr[Gr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gr[Gr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gr[Gr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gr[Gr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gr[Gr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gr[Gr.ABORTED=10]="ABORTED",Gr[Gr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gr[Gr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gr[Gr.INTERNAL=13]="INTERNAL",Gr[Gr.UNAVAILABLE=14]="UNAVAILABLE",Gr[Gr.DATA_LOSS=15]="DATA_LOSS";class zr{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){es(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return ns(this.inner)}size(){return this.innerSize}}const Qr=new Ks($i.comparator);function Xr(){return Qr}const Wr=new Ks($i.comparator);function Yr(...t){let e=Wr;for(const n of t)e=e.insert(n.key,n);return e}function Jr(t){let e=Wr;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Zr(){return eo()}function to(){return eo()}function eo(){return new zr((t=>t.toString()),((t,e)=>t.isEqual(e)))}const no=new Ks($i.comparator),io=new Qs($i.comparator);function so(...t){let e=io;for(const n of t)e=e.add(n);return e}const ro=new Qs(xi);class oo{constructor(t,e){this.databaseId=t,this.wt=e}}function ao(t,e){return t.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function co(t,e){return t.wt?e.toBase64():e.toUint8Array()}function lo(t,e){return ao(t,e.toTimestamp())}function ho(t){return wi(!!t),Fi.fromTimestamp(function(t){const e=as(t);return new Pi(e.seconds,e.nanos)}(t))}function uo(t,e){return function(t){return new Ui(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function fo(t,e){return uo(t.databaseId,e.path)}function po(t){const e=function(t){const e=Ui.fromString(t);return wi(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?Ui.emptyPath():function(t){return wi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function go(t,e,n){return{name:fo(t,e),fields:n.value.mapValue.fields}}function mo(t){let e=po(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){wi(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=function(t){const e=yo(t);return e instanceof Ns&&Ls(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new qs(vo(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,is(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Ss(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new Ss(n,e)}(n.endAt)),function(t,e,n,i,s,r,o,a){return new sr(t,e,n,i,s,r,o,a)}(e,s,o,r,a,"F",c,l)}function yo(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=vo(t.unaryFilter.field);return _s.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=vo(t.unaryFilter.field);return _s.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=vo(t.unaryFilter.field);return _s.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=vo(t.unaryFilter.field);return _s.create(s,"!=",{nullValue:"NULL_VALUE"});default:return vi()}}(t):void 0!==t.fieldFilter?function(t){return _s.create(vo(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return vi()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Ns.create(t.compositeFilter.filters.map((t=>yo(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return vi()}}(t.compositeFilter.op))}(t):vi()}function vo(t){return ji.fromServerFormat(t.fieldPath)}function wo(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class bo{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&xr(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Mr(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Mr(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=to();return this.mutations.forEach((i=>{const s=t.get(i.key),r=s.overlayedDocument;let o=this.applyToLocalView(r,s.mutatedFields);o=e.has(i.key)?null:o;const a=Rr(r,o);null!==a&&n.set(i.key,a),r.isValidDocument()||r.convertToNoDocument(Fi.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),so())}isEqual(t){return this.batchId===t.batchId&&Mi(this.mutations,t.mutations,((t,e)=>Fr(t,e)))&&Mi(this.baseMutations,t.baseMutations,((t,e)=>Fr(t,e)))}}class Eo{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){wi(t.mutations.length===n.length);let i=no;const s=t.mutations;for(let t=0;t<s.length;t++)i=i.insert(s[t].key,n[t].version);return new Eo(t,e,n,i)}}class Io{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class To{constructor(t){this.ie=t}}function So(t){const e=mo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?cr(e,e.limit,"L"):e}class Co{constructor(){}ue(t,e){this.ce(t,e),e.ae()}ce(t,e){if("nullValue"in t)this.he(e,5);else if("booleanValue"in t)this.he(e,10),e.le(t.booleanValue?1:0);else if("integerValue"in t)this.he(e,15),e.le(cs(t.integerValue));else if("doubleValue"in t){const n=cs(t.doubleValue);isNaN(n)?this.he(e,13):(this.he(e,15),ss(n)?e.le(0):e.le(n))}else if("timestampValue"in t){const n=t.timestampValue;this.he(e,20),"string"==typeof n?e.fe(n):(e.fe(`${n.seconds||""}`),e.le(n.nanos||0))}else if("stringValue"in t)this.de(t.stringValue,e),this._e(e);else if("bytesValue"in t)this.he(e,30),e.we(ls(t.bytesValue)),this._e(e);else if("referenceValue"in t)this.me(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.he(e,45),e.le(n.latitude||0),e.le(n.longitude||0)}else"mapValue"in t?Ts(t)?this.he(e,Number.MAX_SAFE_INTEGER):(this.ge(t.mapValue,e),this._e(e)):"arrayValue"in t?(this.ye(t.arrayValue,e),this._e(e)):vi()}de(t,e){this.he(e,25),this.pe(t,e)}pe(t,e){e.fe(t)}ge(t,e){const n=t.fields||{};this.he(e,55);for(const t of Object.keys(n))this.de(t,e),this.ce(n[t],e)}ye(t,e){const n=t.values||[];this.he(e,50);for(const t of n)this.ce(t,e)}me(t,e){this.he(e,37),$i.fromName(t).path.forEach((t=>{this.he(e,60),this.pe(t,e)}))}he(t,e){t.le(e)}_e(t){t.le(2)}}Co.Ie=new Co;class Ao{constructor(){this.Je=new Do}addToCollectionParentIndex(t,e){return this.Je.add(e),Xi.resolve()}getCollectionParents(t,e){return Xi.resolve(this.Je.getEntries(e))}addFieldIndex(t,e){return Xi.resolve()}deleteFieldIndex(t,e){return Xi.resolve()}getDocumentsMatchingTarget(t,e){return Xi.resolve(null)}getIndexType(t,e){return Xi.resolve(0)}getFieldIndexes(t,e){return Xi.resolve([])}getNextCollectionGroupToUpdate(t){return Xi.resolve(null)}getMinOffset(t,e){return Xi.resolve(Hi.min())}getMinOffsetFromCollectionGroup(t,e){return Xi.resolve(Hi.min())}updateCollectionGroup(t,e,n){return Xi.resolve()}updateIndexEntries(t,e){return Xi.resolve()}}class Do{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Qs(Ui.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Qs(Ui.comparator)).toArray()}}new Uint8Array(0);class _o{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new _o(t,_o.DEFAULT_COLLECTION_PERCENTILE,_o.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}_o.DEFAULT_COLLECTION_PERCENTILE=10,_o.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_o.DEFAULT=new _o(41943040,_o.DEFAULT_COLLECTION_PERCENTILE,_o.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_o.DISABLED=new _o(-1,0,0);class No{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new No(0)}static vn(){return new No(-1)}}class ko{constructor(){this.changes=new zr((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Zs.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Xi.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Lo{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Oo{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&Mr(n.mutation,t,Ws.empty(),Pi.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,so()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=so()){const i=Zr();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=Yr();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Zr();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,so())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let s=Xr();const r=eo(),o=eo();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Ur)?s=s.insert(e.key,e):void 0!==o?(r.set(e.key,o.mutation.getFieldMask()),Mr(o.mutation,e,o.mutation.getFieldMask(),Pi.now())):r.set(e.key,Ws.empty())})),this.recalculateAndSaveOverlays(t,s).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new Lo(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=eo();let i=new Ks(((t,e)=>t-e)),s=so();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const s of t)s.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||Ws.empty();o=s.applyToLocalView(r,o),n.set(t,o);const a=(i.get(s.batchId)||so()).add(t);i=i.insert(s.batchId,a)}))})).next((()=>{const r=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=to();c.forEach((t=>{if(!s.has(t)){const i=Rr(e.get(t),n.get(t));null!==i&&l.set(t,i),s=s.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Xi.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return $i.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-s.size):Xi.resolve(Zr());let o=-1,a=s;return r.next((e=>Xi.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(e)?Xi.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,s))).next((()=>this.computeViews(t,a,e,so()))).next((t=>({batchId:o,changes:Jr(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new $i(e)).next((t=>{let e=Yr();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let s=Yr();return this.indexManager.getCollectionParents(t,i).next((r=>Xi.forEach(r,(r=>{const o=function(t,e){return new sr(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(i));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i)))).next((t=>{i.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Zs.newInvalidDocument(i)))}));let n=Yr();return t.forEach(((t,s)=>{const r=i.get(t);void 0!==r&&Mr(r.mutation,s,Ws.empty(),Pi.now()),fr(e,s)&&(n=n.insert(t,s))})),n}))}}class Ro{constructor(t){this.yt=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Xi.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:ho(n.createTime)}),Xi.resolve()}getNamedQuery(t,e){return Xi.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,function(t){return{name:t.name,query:So(t.bundledQuery),readTime:ho(t.readTime)}}(e)),Xi.resolve()}}class xo{constructor(){this.overlays=new Ks($i.comparator),this.es=new Map}getOverlay(t,e){return Xi.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Zr();return Xi.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.oe(t,e,i)})),Xi.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.es.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.es.delete(n)),Xi.resolve()}getOverlaysForCollection(t,e,n){const i=Zr(),s=e.length+1,r=new $i(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Xi.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new Ks(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=Zr(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Zr(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Xi.resolve(o)}oe(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.es.get(i.largestBatchId).delete(n.key);this.es.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Io(e,n));let s=this.es.get(e);void 0===s&&(s=so(),this.es.set(e,s)),this.es.set(e,s.add(n.key))}}class Mo{constructor(){this.ns=new Qs(Po.ss),this.rs=new Qs(Po.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new Po(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.cs(new Po(t,e))}hs(t,e){t.forEach((t=>this.removeReference(t,e)))}ls(t){const e=new $i(new Ui([])),n=new Po(e,t),i=new Po(e,t+1),s=[];return this.rs.forEachInRange([n,i],(t=>{this.cs(t),s.push(t.key)})),s}fs(){this.ns.forEach((t=>this.cs(t)))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new $i(new Ui([])),n=new Po(e,t),i=new Po(e,t+1);let s=so();return this.rs.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new Po(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Po{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return $i.comparator(t.key,e.key)||xi(t._s,e._s)}static os(t,e){return xi(t._s,e._s)||$i.comparator(t.key,e.key)}}class Fo{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new Qs(Po.ss)}checkEmpty(t){return Xi.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const s=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new bo(s,e,n,i);this.mutationQueue.push(r);for(const e of i)this.gs=this.gs.add(new Po(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Xi.resolve(r)}lookupMutationBatch(t,e){return Xi.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ps(n),s=i<0?0:i;return Xi.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Xi.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Xi.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Po(e,0),i=new Po(e,Number.POSITIVE_INFINITY),s=[];return this.gs.forEachInRange([n,i],(t=>{const e=this.ys(t._s);s.push(e)})),Xi.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Qs(xi);return e.forEach((t=>{const e=new Po(t,0),i=new Po(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,i],(t=>{n=n.add(t._s)}))})),Xi.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;$i.isDocumentKey(s)||(s=s.child(""));const r=new Po(new $i(s),0);let o=new Qs(xi);return this.gs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t._s)),!0)}),r),Xi.resolve(this.Is(o))}Is(t){const e=[];return t.forEach((t=>{const n=this.ys(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){wi(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return Xi.forEach(e.mutations,(i=>{const s=new Po(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.gs=n}))}An(t){}containsKey(t,e){const n=new Po(e,0),i=this.gs.firstAfterOrEqual(n);return Xi.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Xi.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Vo{constructor(t){this.Es=t,this.docs=new Ks($i.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Xi.resolve(n?n.document.mutableCopy():Zs.newInvalidDocument(e))}getEntries(t,e){let n=Xr();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Zs.newInvalidDocument(t))})),Xi.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let s=Xr();const r=e.path,o=new $i(r.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!r.isPrefixOf(t.path))break;t.path.length>r.length+1||Ki(qi(o),n)<=0||(i.has(o.key)||fr(e,o))&&(s=s.insert(o.key,o.mutableCopy()))}return Xi.resolve(s)}getAllFromCollectionGroup(t,e,n,i){vi()}As(t,e){return Xi.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Uo(this)}getSize(t){return Xi.resolve(this.size)}}class Uo extends ko{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Yn.addEntry(t,i)):this.Yn.removeEntry(n)})),Xi.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Bo{constructor(t){this.persistence=t,this.Rs=new zr((t=>nr(t)),ir),this.lastRemoteSnapshotVersion=Fi.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Mo,this.targetCount=0,this.vs=No.Pn()}forEachTarget(t,e){return this.Rs.forEach(((t,n)=>e(n))),Xi.resolve()}getLastRemoteSnapshotVersion(t){return Xi.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Xi.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Xi.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),Xi.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new No(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Xi.resolve()}updateTargetData(t,e){return this.Dn(e),Xi.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Xi.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.Rs.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(r),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Xi.waitFor(s).next((()=>i))}getTargetCount(t){return Xi.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return Xi.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),Xi.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),Xi.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Xi.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return Xi.resolve(n)}containsKey(t,e){return Xi.resolve(this.Ps.containsKey(e))}}class jo{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new Yi(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Bo(this),this.indexManager=new Ao,this.remoteDocumentCache=function(t){return new Vo(t)}((t=>this.referenceDelegate.xs(t))),this.yt=new To(e),this.Ns=new Ro(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new xo,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new Fo(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){pi("MemoryPersistence","Starting transaction:",t);const i=new $o(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((t=>this.referenceDelegate.Os(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ms(t,e){return Xi.or(Object.values(this.Vs).map((n=>()=>n.containsKey(t,e))))}}class $o extends zi{constructor(t){super(),this.currentSequenceNumber=t}}class qo{constructor(t){this.persistence=t,this.Fs=new Mo,this.$s=null}static Bs(t){return new qo(t)}get Ls(){if(this.$s)return this.$s;throw vi()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),Xi.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),Xi.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Xi.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach((t=>this.Ls.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ls.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xi.forEach(this.Ls,(n=>{const i=$i.fromPath(n);return this.qs(t,i).next((t=>{t||e.removeEntry(i,Fi.min())}))})).next((()=>(this.$s=null,e.apply(t))))}updateLimboDocument(t,e){return this.qs(t,e).next((t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())}))}xs(t){return 0}qs(t,e){return Xi.or([()=>Xi.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class Ho{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=i}static Ci(t,e){let n=so(),i=so();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Ho(t,e.fromCache,n,i)}}class Ko{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.ki(t,e).next((s=>s||this.Oi(t,e,i,n))).next((n=>n||this.Mi(t,e)))}ki(t,e){if(rr(e))return Xi.resolve(null);let n=ar(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=cr(e,null,"F"),n=ar(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const s=so(...i);return this.Ni.getDocuments(t,s).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.Fi(e,i);return this.$i(e,r,s,n.readTime)?this.ki(t,cr(e,null,"F")):this.Bi(t,r,e,n)}))))})))))}Oi(t,e,n,i){return rr(e)||i.isEqual(Fi.min())?this.Mi(t,e):this.Ni.getDocuments(t,n).next((s=>{const r=this.Fi(e,s);return this.$i(e,r,n,i)?this.Mi(t,e):(di()<=o.in.DEBUG&&pi("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ur(e)),this.Bi(t,r,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=Fi.fromTimestamp(1e9===i?new Pi(n+1,0):new Pi(n,i));return new Hi(s,$i.empty(),e)}(i,-1)))}))}Fi(t,e){let n=new Qs(function(t){return(e,n)=>{let i=!1;for(const s of or(t)){const t=dr(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{fr(t,i)&&(n=n.add(i))})),n}$i(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Mi(t,e){return di()<=o.in.DEBUG&&pi("QueryEngine","Using full collection scan to execute query:",ur(e)),this.Ni.getDocumentsMatchingQuery(t,e,Hi.min())}Bi(t,e,n,i){return this.Ni.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Go{constructor(t,e,n,i){this.persistence=t,this.Li=e,this.yt=i,this.qi=new Ks(xi),this.Ui=new zr((t=>nr(t)),ir),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Oo(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.qi)))}}async function zo(t,e){const n=bi(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((s=>(i=s,n.Qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let o=so();for(const t of i){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ji:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function Qo(t,e){const n=bi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class Xo{constructor(){this.activeTargetIds=ro}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Wo{constructor(){this.Lr=new Xo,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.qr[t]||"not-current"}updateQueryState(t,e,n){this.qr[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.qr[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Xo,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Yo{Ur(t){}shutdown(){}}class Jo{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){pi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){pi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Zo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ta{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class ea extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.oo=e+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,n,i,s){const r=this.ho(t,e);pi("RestConnection","Sending: ",r,n);const o={};return this.lo(o,i,s),this.fo(t,r,o,n).then((t=>(pi("RestConnection","Received: ",t),t)),(e=>{throw mi("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}_o(t,e,n,i,s,r){return this.ao(t,e,n,i,s)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ui,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=Zo[t];return`${this.oo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,i){return new Promise(((s,r)=>{const o=new ci;o.setWithCredentials(!0),o.listenOnce(ii.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case ni.NO_ERROR:const e=o.getResponseJson();pi("Connection","XHR received:",JSON.stringify(e)),s(e);break;case ni.TIMEOUT:pi("Connection",'RPC "'+t+'" timed out'),r(new Ii(Ei.DEADLINE_EXCEEDED,"Request time out"));break;case ni.HTTP_ERROR:const n=o.getStatus();if(pi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ei).indexOf(e)>=0?e:Ei.UNKNOWN}(e.status);r(new Ii(t,e.message))}else r(new Ii(Ei.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Ii(Ei.UNAVAILABLE,"Connection failed."));break;default:vi()}}finally{pi("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}wo(t,e,n){const i=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=ti(),r=ei(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new oi({})),this.lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const a=i.join("");pi("Connection","Creating WebChannel: "+a,o);const c=s.createWebChannel(a,o);let l=!1,h=!1;const u=new ta({Hr:t=>{h?pi("Connection","Not sending because WebChannel is closed:",t):(l||(pi("Connection","Opening WebChannel transport."),c.open(),l=!0),pi("Connection","WebChannel sending:",t),c.send(t))},Jr:()=>c.close()}),f=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return f(c,ai.EventType.OPEN,(()=>{h||pi("Connection","WebChannel transport opened.")})),f(c,ai.EventType.CLOSE,(()=>{h||(h=!0,pi("Connection","WebChannel transport closed"),u.io())})),f(c,ai.EventType.ERROR,(t=>{h||(h=!0,mi("Connection","WebChannel transport errored:",t),u.io(new Ii(Ei.UNAVAILABLE,"The operation could not be completed")))})),f(c,ai.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];wi(!!n);const i=n,s=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(s){pi("Connection","WebChannel received error:",s);const t=s.status;let e=function(t){const e=Kr[t];if(void 0!==e)return function(t){if(void 0===t)return gi("GRPC error has no .code"),Ei.UNKNOWN;switch(t){case Kr.OK:return Ei.OK;case Kr.CANCELLED:return Ei.CANCELLED;case Kr.UNKNOWN:return Ei.UNKNOWN;case Kr.DEADLINE_EXCEEDED:return Ei.DEADLINE_EXCEEDED;case Kr.RESOURCE_EXHAUSTED:return Ei.RESOURCE_EXHAUSTED;case Kr.INTERNAL:return Ei.INTERNAL;case Kr.UNAVAILABLE:return Ei.UNAVAILABLE;case Kr.UNAUTHENTICATED:return Ei.UNAUTHENTICATED;case Kr.INVALID_ARGUMENT:return Ei.INVALID_ARGUMENT;case Kr.NOT_FOUND:return Ei.NOT_FOUND;case Kr.ALREADY_EXISTS:return Ei.ALREADY_EXISTS;case Kr.PERMISSION_DENIED:return Ei.PERMISSION_DENIED;case Kr.FAILED_PRECONDITION:return Ei.FAILED_PRECONDITION;case Kr.ABORTED:return Ei.ABORTED;case Kr.OUT_OF_RANGE:return Ei.OUT_OF_RANGE;case Kr.UNIMPLEMENTED:return Ei.UNIMPLEMENTED;case Kr.DATA_LOSS:return Ei.DATA_LOSS;default:return vi()}}(e)}(t),n=s.message;void 0===e&&(e=Ei.INTERNAL,n="Unknown error status: "+t+" with message "+s.message),h=!0,u.io(new Ii(e,n)),c.close()}else pi("Connection","WebChannel received:",n),u.ro(n)}})),f(r,si.STAT_EVENT,(t=>{t.stat===ri.PROXY?pi("Connection","Detected buffering proxy"):t.stat===ri.NOPROXY&&pi("Connection","Detected no buffering proxy")})),setTimeout((()=>{u.so()}),0),u}}function na(){return"undefined"!=typeof document?document:null}function ia(t){return new oo(t,!0)}class sa{constructor(t,e,n=1e3,i=1.5,s=6e4){this.Hs=t,this.timerId=e,this.mo=n,this.yo=i,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),i=Math.max(0,e-n);i>0&&pi("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class ra{constructor(t,e,n,i,s,r,o,a){this.Hs=t,this.vo=n,this.Vo=i,this.connection=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new sa(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(t){this.Lo(),this.stream.send(t)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(t,e){this.Lo(),this.qo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():e&&e.code===Ei.RESOURCE_EXHAUSTED?(gi(e.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):e&&e.code===Ei.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Uo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Zr(e)}Uo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.So===e&&this.Go(t,n)}),(e=>{t((()=>{const t=new Ii(Ei.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)}))}))}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((t=>{n((()=>this.Qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(t){return pi("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget((()=>this.So===t?e():(pi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class oa extends ra{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.yt=s,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(wi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(wi(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?ho(t.updateTime):ho(e);return n.isEqual(Fi.min())&&(n=ho(e)),new Nr(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=ho(t.commitTime);return this.listener.Zo(n,e)}return wi(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=function(t){return new Ui(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.yt),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Vr)n={update:go(t,e.key,e.value)};else if(e instanceof qr)n={delete:fo(t,e.key)};else if(e instanceof Ur)n={update:go(t,e.key,e.data),updateMask:wo(e.fieldMask)};else{if(!(e instanceof Hr))return vi();n={verify:fo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Er)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ir)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Sr)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ar)return{fieldPath:e.field.canonicalString(),increment:n.gt};throw vi()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:lo(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:vi()}(t,e.precondition)),n}(this.yt,t)))};this.Bo(e)}}class aa extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.yt=i,this.nu=!1}su(){if(this.nu)throw new Ii(Ei.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.ao(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ei.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Ii(Ei.UNKNOWN,t.toString())}))}_o(t,e,n,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.connection._o(t,e,n,s,r,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ei.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Ii(Ei.UNKNOWN,t.toString())}))}terminate(){this.nu=!0}}class ca{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(gi(e),this.ou=!1):pi("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class la{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=s,this.mu.Ur((t=>{n.enqueueAndForget((async()=>{fa(this)&&(pi("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=bi(t);e._u.add(4),await ua(e),e.gu.set("Unknown"),e._u.delete(4),await ha(e)}(this))}))})),this.gu=new ca(n,i)}}async function ha(t){if(fa(t))for(const e of t.wu)await e(!0)}async function ua(t){for(const e of t.wu)await e(!1)}function fa(t){return 0===bi(t)._u.size}async function da(t,e,n){if(!Wi(e))throw e;t._u.add(1),await ua(t),t.gu.set("Offline"),n||(n=()=>function(t){const e=bi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Cs.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{pi("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await ha(t)}))}function pa(t,e){return e().catch((n=>da(t,n,e)))}async function ga(t){const e=bi(t),n=Ca(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;ma(e);)try{const t=await Qo(e.localStore,i);if(null===t){0===e.fu.length&&n.Fo();break}i=t.batchId,ya(e,t)}catch(t){await da(e,t)}va(e)&&wa(e)}function ma(t){return fa(t)&&t.fu.length<10}function ya(t,e){t.fu.push(e);const n=Ca(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function va(t){return fa(t)&&!Ca(t).No()&&t.fu.length>0}function wa(t){Ca(t).start()}async function ba(t){Ca(t).eu()}async function Ea(t){const e=Ca(t);for(const n of t.fu)e.Xo(n.mutations)}async function Ia(t,e,n){const i=t.fu.shift(),s=Eo.from(i,e,n);await pa(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await ga(t)}async function Ta(t,e){e&&Ca(t).Yo&&await async function(t,e){if(function(t){switch(t){default:return vi();case Ei.CANCELLED:case Ei.UNKNOWN:case Ei.DEADLINE_EXCEEDED:case Ei.RESOURCE_EXHAUSTED:case Ei.INTERNAL:case Ei.UNAVAILABLE:case Ei.UNAUTHENTICATED:return!1;case Ei.INVALID_ARGUMENT:case Ei.NOT_FOUND:case Ei.ALREADY_EXISTS:case Ei.PERMISSION_DENIED:case Ei.FAILED_PRECONDITION:case Ei.ABORTED:case Ei.OUT_OF_RANGE:case Ei.UNIMPLEMENTED:case Ei.DATA_LOSS:return!0}}(n=e.code)&&n!==Ei.ABORTED){const n=t.fu.shift();Ca(t).Mo(),await pa(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await ga(t)}var n}(t,e),va(t)&&wa(t)}async function Sa(t,e){const n=bi(t);n.asyncQueue.verifyOperationInProgress(),pi("RemoteStore","RemoteStore received new credentials");const i=fa(n);n._u.add(3),await ua(n),i&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await ha(n)}function Ca(t){return t.Iu||(t.Iu=function(t,e,n){const i=bi(t);return i.su(),new oa(e,i.connection,i.authCredentials,i.appCheckCredentials,i.yt,n)}(t.datastore,t.asyncQueue,{Yr:ba.bind(null,t),Zr:Ta.bind(null,t),tu:Ea.bind(null,t),Zo:Ia.bind(null,t)}),t.wu.push((async e=>{e?(t.Iu.Mo(),await ga(t)):(await t.Iu.stop(),t.fu.length>0&&(pi("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))}))),t.Iu}class Aa{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ti,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,o=new Aa(t,e,r,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ii(Ei.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Da(t,e){if(gi("AsyncQueue",`${e}: ${t}`),Wi(t))return new Ii(Ei.UNAVAILABLE,`${e}: ${t}`);throw t}class _a{constructor(){this.queries=new zr((t=>hr(t)),lr),this.onlineState="Unknown",this.Ru=new Set}}class Na{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.sc={},this.ic=new zr((t=>hr(t)),lr),this.rc=new Map,this.oc=new Set,this.uc=new Ks($i.comparator),this.cc=new Map,this.ac=new Mo,this.hc={},this.lc=new Map,this.fc=No.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function ka(t,e,n){const i=bi(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ic.forEach(((n,i)=>{const s=i.view.bu(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=bi(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.bu(e)&&(i=!0)})),i&&function(t){t.Ru.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.sc.Wo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function La(t,e){const n=bi(t),i=e.batch.batchId;try{const t=await function(t,e){const n=bi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let o=Xi.resolve();return r.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);wi(null!==r),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=so();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);xa(n,i,null),Ra(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Ma(n,t)}catch(t){await Qi(t)}}async function Oa(t,e,n){const i=bi(t);try{const t=await function(t,e){const n=bi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(wi(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);xa(i,e,n),Ra(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Ma(i,t)}catch(n){await Qi(n)}}function Ra(t,e){(t.lc.get(e)||[]).forEach((t=>{t.resolve()})),t.lc.delete(e)}function xa(t,e,n){const i=bi(t);let s=i.hc[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.hc[i.currentUser.toKey()]=s}}async function Ma(t,e,n){const i=bi(t),s=[],r=[],o=[];i.ic.isEmpty()||(i.ic.forEach(((t,a)=>{o.push(i._c(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){s.push(t);const e=Ho.Ci(a.targetId,t);r.push(e)}})))})),await Promise.all(o),i.sc.Wo(s),await async function(t,e){const n=bi(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Xi.forEach(e,(e=>Xi.forEach(e.Si,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Xi.forEach(e.Di,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Wi(t))throw t;pi("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.qi.get(e),i=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(i);n.qi=n.qi.insert(e,s)}}}(i.localStore,r))}async function Pa(t,e){const n=bi(t);if(!n.currentUser.isEqual(e)){pi("SyncEngine","User change. New user:",e.toKey());const t=await zo(n.localStore,e);n.currentUser=e,function(t,e){t.lc.forEach((t=>{t.forEach((t=>{t.reject(new Ii(Ei.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ma(n,t.ji)}}function Fa(t){const e=bi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=La.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Oa.bind(null,e),e}class Va{constructor(){this.synchronizeTabs=!1}async initialize(t){this.yt=ia(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),await this.persistence.start(),this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore)}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function(t,e,n,i){return new Go(t,e,n,i)}(this.persistence,new Ko,t.initialUser,this.yt)}yc(t){return new jo(qo.Bs,this.yt)}gc(t){return new Wo}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ua{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>ka(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Pa.bind(null,this.syncEngine),await async function(t,e){const n=bi(t);e?(n._u.delete(2),await ha(n)):e||(n._u.add(2),await ua(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new _a}createDatastore(t){const e=ia(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new ea(i));var i;return function(t,e,n,i){return new aa(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,s=t=>ka(this.syncEngine,t,0),r=Jo.C()?new Jo:new Yo,new la(e,n,i,s,r);var e,n,i,s,r}createSyncEngine(t,e){return function(t,e,n,i,s,r,o){const a=new Na(t,e,n,i,s,r);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=bi(t);pi("RemoteStore","RemoteStore shutting down."),e._u.add(5),await ua(e),e.mu.shutdown(),e.gu.set("Unknown")}(this.remoteStore)}}function Ba(t,e,n){if(!n)throw new Ii(Ei.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ja(t){if(!$i.isDocumentKey(t))throw new Ii(Ei.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $a(t){if($i.isDocumentKey(t))throw new Ii(Ei.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function qa(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":vi()}function Ha(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ii(Ei.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qa(t);throw new Ii(Ei.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const Ka=new Map;class Ga{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ii(Ei.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ii(Ei.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new Ii(Ei.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class za{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ga({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ii(Ei.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Ii(Ei.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ga(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Ci;switch(t.type){case"gapi":const e=t.client;return new Ni(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ii(Ei.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Ka.get(t);e&&(pi("ComponentProvider","Removing Datastore"),Ka.delete(t),e.terminate())}(this),Promise.resolve()}}class Qa{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wa(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Qa(this.firestore,t,this._key)}}class Xa{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Xa(this.firestore,t,this._query)}}class Wa extends Xa{constructor(t,e,n){super(t,e,function(t){return new sr(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Qa(this.firestore,null,new $i(t))}withConverter(t){return new Wa(this.firestore,t,this._path)}}function Ya(t,e,...n){if(t=(0,a.m9)(t),Ba("collection","path",e),t instanceof za){const i=Ui.fromString(e,...n);return $a(i),new Wa(t,null,i)}{if(!(t instanceof Qa||t instanceof Wa))throw new Ii(Ei.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ui.fromString(e,...n));return $a(i),new Wa(t.firestore,null,i)}}class Ja{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=hi.UNAUTHENTICATED,this.clientId=Ri.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{pi("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(pi("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ii(Ei.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ti;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Da(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Za(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(pi("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),pi("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await zo(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Va)),t.offlineComponents}(t);pi("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>Sa(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Sa(e.remoteStore,n))),t.onlineComponents=e}function tc(t){return async function(t){return t.onlineComponents||(pi("FirestoreClient","Using default OnlineComponentProvider"),await Za(t,new Ua)),t.onlineComponents}(t).then((t=>t.syncEngine))}class ec{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new sa(this,"async_queue_retry"),this.Wc=()=>{const t=na();t&&pi("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const t=na();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.qc){this.qc=!0,this.Qc=t||!1;const e=na();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.qc)return new Promise((()=>{}));const e=new Ti;return this.Hc((()=>this.qc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Lc.push(t),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(t){if(!Wi(t))throw t;pi("AsyncQueue","Operation failed with retryable error: "+t)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(t){const e=this.Bc.then((()=>(this.Gc=!0,t().catch((t=>{this.Kc=t,this.Gc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw gi("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Gc=!1,t))))));return this.Bc=e,e}enqueueAfterDelay(t,e,n){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const i=Aa.createAndSchedule(this,t,e,n,(t=>this.Yc(t)));return this.Uc.push(i),i}zc(){this.Kc&&vi()}verifyOperationInProgress(){}async Xc(){let t;do{t=this.Bc,await t}while(t!==this.Bc)}Zc(t){for(const e of this.Uc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then((()=>{this.Uc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Uc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()}))}ea(t){this.jc.push(t)}Yc(t){const e=this.Uc.indexOf(t);this.Uc.splice(e,1)}}class nc extends za{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new ec,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||sc(this),this._firestoreClient.terminate()}}function ic(t,e){const n="object"==typeof t?t:(0,s.Mq)(),i="string"==typeof t?t:e||"(default)",r=(0,s.qX)(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const t=(0,a.P0)("firestore");t&&function(t,e,n,i={}){var s;const r=(t=Ha(t,za))._getSettings();if("firestore.googleapis.com"!==r.host&&r.host!==e&&mi("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},r),{host:`${e}:${n}`,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=hi.MOCK_USER;else{e=(0,a.Sg)(i.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const r=i.mockUserToken.sub||i.mockUserToken.user_id;if(!r)throw new Ii(Ei.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new hi(r)}t._authCredentials=new Ai(new Si(e,n))}}(r,...t)}return r}function sc(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Ji(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Ja(t._authCredentials,t._appCheckCredentials,t._queue,i)}class rc{constructor(t){this._byteString=t}static fromBase64String(t){try{return new rc(rs.fromBase64String(t))}catch(t){throw new Ii(Ei.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new rc(rs.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class oc{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Ii(Ei.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ji(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class ac{constructor(t){this._methodName=t}}class cc{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ii(Ei.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ii(Ei.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return xi(this._lat,t._lat)||xi(this._long,t._long)}}const lc=/^__.*__$/;class hc{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Ur(t,this.data,this.fieldMask,e,this.fieldTransforms):new Vr(t,this.data,e,this.fieldTransforms)}}function uc(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vi()}}class fc{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.yt=n,this.ignoreUndefinedProperties=i,void 0===s&&this.na(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new fc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.ua(t),i}ca(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.na(),i}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return Ic(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(uc(this.sa)&&lc.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class dc{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.yt=n||ia(t)}da(t,e,n,i=!1){return new fc({sa:t,methodName:e,fa:n,path:ji.emptyPath(),oa:!1,la:i},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function pc(t){const e=t._freezeSettings(),n=ia(t._databaseId);return new dc(t._databaseId,!!e.ignoreUndefinedProperties,n)}function gc(t,e,n,i,s,r={}){const o=t.da(r.merge||r.mergeFields?2:0,e,n,s);wc("Data must be an object, but it was:",o,i);const a=yc(i,o);let c,l;if(r.merge)c=new Ws(o.fieldMask),l=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=bc(e,i,n);if(!o.contains(s))throw new Ii(Ei.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);Tc(t,s)||t.push(s)}c=new Ws(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new hc(new Ys(a),c,l)}function mc(t,e){if(vc(t=(0,a.m9)(t)))return wc("Unsupported field value:",e,t),yc(t,e);if(t instanceof ac)return function(t,e){if(!uc(e.sa))throw e.ha(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ha(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=mc(s,e.aa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,a.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return mr(e.yt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Pi.fromDate(t);return{timestampValue:ao(e.yt,n)}}if(t instanceof Pi){const n=new Pi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ao(e.yt,n)}}if(t instanceof cc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof rc)return{bytesValue:co(e.yt,t._byteString)};if(t instanceof Qa){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:uo(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ha(`Unsupported field value: ${qa(t)}`)}(t,e)}function yc(t,e){const n={};return ns(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):es(t,((t,i)=>{const s=mc(i,e.ra(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function vc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pi||t instanceof cc||t instanceof rc||t instanceof Qa||t instanceof ac)}function wc(t,e,n){if(!vc(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=qa(n);throw"an object"===i?e.ha(t+" a custom object"):e.ha(t+" "+i)}}function bc(t,e,n){if((e=(0,a.m9)(e))instanceof oc)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(Ec)>=0)throw Ic(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new oc(...e.split("."))._internalPath}catch(i){throw Ic(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw Ic("Field path arguments must be of type string or ",t,!1,void 0,n)}const Ec=new RegExp("[~\\*/\\[\\]]");function Ic(t,e,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new Ii(Ei.INVALID_ARGUMENT,a+t+c)}function Tc(t,e){return t.some((t=>t.isEqual(e)))}function Sc(t,e){const n=Ha(t.firestore,nc),i=function(t,e,...n){if(t=(0,a.m9)(t),1===arguments.length&&(e=Ri.R()),Ba("doc","path",e),t instanceof za){const i=Ui.fromString(e,...n);return ja(i),new Qa(t,null,new $i(i))}{if(!(t instanceof Qa||t instanceof Wa))throw new Ii(Ei.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ui.fromString(e,...n));return ja(i),new Qa(t.firestore,t instanceof Wa?t.converter:null,new $i(i))}}(t),s=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new Ti;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Fa(t);try{const t=await function(t,e){const n=bi(t),i=Pi.now(),s=e.reduce(((t,e)=>t.add(e.key)),so());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Xr(),c=so();return n.Gi.getEntries(t,s).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((s=>{r=s;const o=[];for(const t of e){const e=Pr(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new Ur(t.key,e,Js(e.value.mapValue),kr.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:Jr(r)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.hc[t.currentUser.toKey()];i||(i=new Ks(xi)),i=i.insert(e,n),t.hc[t.currentUser.toKey()]=i}(i,t.batchId,n),await Ma(i,t.changes),await ga(i.remoteStore)}catch(t){const e=Da(t,"Failed to persist write");n.reject(e)}}(await tc(t),e,n))),n.promise}(function(t){return t._firestoreClient||sc(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[gc(pc(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,kr.exists(!1))]).then((()=>i))}!function(t,e=!0){!function(t){ui=t}(s.Jn),(0,s.Xd)(new r.wA("firestore",((t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),r=new nc(new Di(t.getProvider("auth-internal")),new Li(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ii(Ei.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zi(t.options.projectId,e)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),r._setSettings(i),r}),"PUBLIC").setMultipleInstances(!0)),(0,s.KN)(li,"3.8.3",t),(0,s.KN)(li,"3.8.3","esm2017")}()},424:(t,e,n)=>{n.d(e,{X3:()=>g});const i=(t,e)=>e.some((e=>t instanceof e));let s,r;const o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,h=new WeakMap;let u={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return a.get(t);if("objectStoreNames"===e)return t.objectStoreNames||c.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function f(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(p(this),t),d(o.get(this))}:function(...t){return d(e.apply(p(this),t))}:function(t,...n){const i=e.call(p(this),t,...n);return c.set(i,t.sort?t.sort():[t]),d(i)}:(t instanceof IDBTransaction&&function(t){if(a.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));a.set(t,e)}(t),i(t,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,u):t);var e}function d(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(d(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&o.set(e,t)})).catch((()=>{})),h.set(e,t),e}(t);if(l.has(t))return l.get(t);const e=f(t);return e!==t&&(l.set(t,e),h.set(e,t)),e}const p=t=>h.get(t);function g(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=d(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(d(o.result),t.oldVersion,t.newVersion,d(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}const m=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],v=new Map;function w(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(v.get(e))return v.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=y.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!m.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return v.set(e,r),r}var b;b=u,u={...b,get:(t,e,n)=>w(t,e)||b.get(t,e,n),has:(t,e)=>!!w(t,e)||b.has(t,e)}}},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var n=r[t]={exports:{}};return s[t](n,n.exports,o),n.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=t=>{t&&!t.d&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},o.a=(s,r,o)=>{var a;o&&((a=[]).d=1);var c,l,h,u=new Set,f=s.exports,d=new Promise(((t,e)=>{h=e,l=t}));d[e]=f,d[t]=t=>(a&&t(a),u.forEach(t),d.catch((t=>{}))),s.exports=d,r((s=>{var r;c=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[t])return s;if(s.then){var r=[];r.d=0,s.then((t=>{o[e]=t,i(r)}),(t=>{o[n]=t,i(r)}));var o={};return o[t]=t=>t(r),o}}var a={};return a[t]=t=>{},a[e]=s,a})))(s);var o=()=>c.map((t=>{if(t[n])throw t[n];return t[e]})),l=new Promise((e=>{(r=()=>e(o)).r=0;var n=t=>t!==a&&!u.has(t)&&(u.add(t),t&&!t.d&&(r.r++,t.push(r)));c.map((e=>e[t](n)))}));return r.r?l:o()}),(t=>(t?h(d[n]=t):l(f),i(a)))),a&&(a.d=0)},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o(495)})();